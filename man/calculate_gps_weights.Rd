% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fssm_weights.R
\name{calculate_gps_weights}
\alias{calculate_gps_weights}
\title{Calculate GPS Weights for Continuous Treatment}
\usage{
calculate_gps_weights(
  mu_S,
  confounders,
  trim_quantiles = c(0.01, 0.99),
  min_complete = 10
)
}
\arguments{
\item{mu_S}{Numeric vector. Fuzzy sufficiency membership values (0-1 scale).}

\item{confounders}{Data frame. Confounder variables to adjust for.}

\item{trim_quantiles}{Numeric vector of length 2. Quantiles for weight trimming.
Default c(0.01, 0.99) trims at 1st and 99th percentiles.}

\item{min_complete}{Integer. Minimum complete cases required. Default 10.}
}
\value{
A list containing:
\item{weights}{Numeric vector of normalized weights (sum to 1)}
\item{diagnostics}{List with ESS, ESS ratio, model info, and balance stats}
}
\description{
Estimates Generalized Propensity Score (GPS) weights for continuous
fuzzy sufficiency membership. Uses a linear model to estimate the conditional
density of the treatment given confounders, then computes stabilized weights.
}
\details{
The GPS weighting procedure:
\enumerate{
\item Fit linear model: mu_S ~ confounders
\item Compute conditional density: f(mu_S | Z) using residual SD
\item Compute marginal density: f(mu_S) using overall mean/SD
\item Calculate stabilized weight: w = f(mu_S) / f(mu_S | Z)
\item Trim extreme weights and normalize
}

Stabilized weights reduce variance compared to unstabilized weights.
}
\references{
Hirano, K., & Imbens, G. W. (2004). The propensity score with continuous treatments.
Applied Bayesian Modeling and Causal Inference from Incomplete-Data Perspectives.
}
