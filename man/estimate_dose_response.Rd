% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fssm_claims.R
\name{estimate_dose_response}
\alias{estimate_dose_response}
\title{Estimate Dose-Response Function}
\usage{
estimate_dose_response(mu_S, mu_Y, weights, use_gam = TRUE, k = 10)
}
\arguments{
\item{mu_S}{Numeric vector. Sufficiency membership values (0-1).}

\item{mu_Y}{Numeric vector. Outcome membership values (0-1).}

\item{weights}{Numeric vector. Case weights (should sum to 1).}

\item{use_gam}{Logical. Whether to try GAM first. Default TRUE.}

\item{k}{Integer. Number of knots for GAM spline. Default 10.}
}
\value{
A list containing dose-response estimates and predictions.
}
\description{
Estimates the relationship between sufficiency membership (mu_S)
and expected outcome membership (mu_Y) using weighted GAM (preferred) or
linear regression (fallback).
}
\details{
The dose-response function models:
\deqn{E[\mu_Y | \mu_S = s] = f(s)}

Primary method uses GAM with cubic regression splines:
\code{gam(mu_Y ~ s(mu_S, bs = "cr", k = 10), weights = w_i)}

Fallback to weighted linear regression if GAM fails.

Key outputs:
\itemize{
\item E\link{mu_Y | mu_S = 0}: Expected outcome for fully insufficient cases
\item E\link{mu_Y | mu_S = 1}: Expected outcome for fully sufficient cases
\item Uplift = E\link{1} - E\link{0}: Causal effect of moving from insufficient to sufficient
}
}
\keyword{internal}
